# 金玉ボット（Kintama Bot）

Bybitの強制清算データを監視し、平均足の転換シグナルを自動通知するトレーディングボット

## 🎯 特徴

- **リアルタイム清算監視**: Bybitの清算イベントをWebSocketで監視
- **青玉・金玉判定**: ロング清算（青玉）とショート清算（金玉）を自動判別
- **マルチタイムフレーム分析**: 6分足、24分足、144分足（ボス）の階層的分析
- **上位足優先ルール**: 下位足のシグナルトラップを自動排除
- **平均足転換検出**: ノイズの少ない明確なトレンド転換を判定
- **自動通知**: Discord/LINE Notifyへのリアルタイム通知

## 📋 必要条件

- Python 3.8以上
- インターネット接続
- Discord Webhook URL または LINE Notify トークン（オプション）

## 🚀 セットアップ

### 1. 必要なライブラリのインストール

```bash
pip install pandas numpy websocket-client requests python-dotenv
```

### 2. 環境変数の設定

`.env.template` を `.env` にコピーして編集：

```bash
cp .env.template .env
```

`.env` ファイルの内容を編集：

```env
# Discord Webhook URL（オプション）
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/あなたのWebhook URL

# LINE Notify トークン（オプション）
LINE_NOTIFY_TOKEN=あなたのLINE Notifyトークン
```

#### Discord Webhook URLの取得方法

1. Discordサーバーの設定を開く
2. 「連携サービス」→「ウェブフック」
3. 「新しいウェブフック」を作成
4. URLをコピーして `.env` に貼り付け

#### LINE Notify トークンの取得方法

1. https://notify-bot.line.me/my/ にアクセス
2. 「トークンを発行する」をクリック
3. 通知先を選択してトークンを発行
4. トークンをコピーして `.env` に貼り付け

### 3. ボットの起動

```bash
python kintama_bot.py
```

停止する場合は `Ctrl+C` を押してください。

## 📁 ファイル構成

```
金玉ボット/
├── kintama_bot.py          # メイン実行プログラム
├── bybit_liquidation.py    # Bybit清算データ取得
├── heikin_ashi.py          # 平均足計算
├── mtf_analysis.py         # マルチタイムフレーム分析
├── signal_engine.py        # シグナル判定エンジン
├── notifier.py             # 通知システム
├── config.py               # 設定ファイル
├── .env                    # 環境変数（要作成）
├── .env.template           # 環境変数テンプレート
└── README.md               # このファイル
```

## ⚙️ カスタマイズ

`config.py` で以下の設定を変更できます：

- **監視シンボル**: `BYBIT_SYMBOL = "BTCUSDT"`
- **清算異常判定倍率**: `LIQUIDATION_THRESHOLD_MULTIPLIER = 2.0`
- **最低通知優先度**: `MIN_NOTIFICATION_PRIORITY = "中"`
- **デバッグモード**: `DEBUG_MODE = True`

## 🎯 シグナルの種類

### 青玉（ロング清算）
- **意味**: 大量の買いポジションが強制決済された
- **示唆**: 売り圧力が一掃され、上昇しやすい状態
- **シグナル**: 平均足が陽線転換（▲）でロングエントリー検討

### 金玉（ショート清算）
- **意味**: 大量の売りポジションが強制決済された
- **示唆**: 買い圧力が解消され、下落しやすい状態
- **シグナル**: 平均足が陰線転換（▼）でショートエントリー検討

## 📊 時間軸の優先順位

1. **144分足（ボス）**: 最優先。大きなトレンドの方向性を決定
2. **24分足**: 中間。エントリータイミングの精緻化
3. **6分足**: 下位。初動を捉えるが、上位足に従う

### 重要なルール

- 144分足が上昇トレンドの場合、下位足のショートシグナルは無視
- 144分足が下落トレンドの場合、下位足のロングシグナルは無視
- シグナルなし時は「スキャルピングゾーン」として取引を控える

## ⚠️ 注意事項

1. **投資助言ではありません**: このボットは情報提供ツールです
2. **リスク管理は必須**: シグナルに盲従せず、自己責任で判断してください
3. **過去のパフォーマンスは将来を保証しません**
4. **デモ口座でのテストを推奨**: 実運用前に動作確認してください

## 🐛 トラブルシューティング

### WebSocket接続エラー

```
WebSocketエラー: Connection refused
```

→ インターネット接続を確認してください

### 通知が届かない

1. `.env` ファイルの設定を確認
2. Webhook URLやトークンが正しいか確認
3. `config.py` の `MIN_NOTIFICATION_PRIORITY` を "低" に変更してテスト

### シグナルが出ない

- 清算データは市場の急変時に発生します
- デバッグモードをONにして清算イベントが検知されているか確認：

```python
# config.py
DEBUG_MODE = True
```

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🙏 謝辞

このボットは、暗号資産市場の清算データを活用した逆張り戦略に基づいています。

---

**免責事項**: 仮想通貨取引は高リスクです。このツールの使用により生じたいかなる損失についても、開発者は責任を負いません。
